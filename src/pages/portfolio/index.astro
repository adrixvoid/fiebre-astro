---
import { getCollection } from "astro:content";
import Button from "~/components/ui/button/Button.astro";
import Card, { CardContent, CardImage, CardTitle } from "~/components/ui/card";
import Container from "~/components/ui/container/Container.astro";
import Grid from "~/components/ui/grid/Grid.astro";
import Section from "~/components/ui/section/Section.astro";
import BaseHead from "../../components/BaseHead.astro";
import Footer from "../../components/Footer.astro";
import FormattedDate from "../../components/FormattedDate.astro";
import Header from "../../components/Header.astro";
import { SITE_DESCRIPTION, SITE_TITLE } from "../../consts";

const posts = (await getCollection("portfolio")).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
  </head>
  <body>
    <Header />
    <main>
      <Section id="portfolio" marginBottom>
        <Container>
          <Grid>
            {
              posts.map((post) => (
                <article>
                  <Card>
                    <CardImage
                      width={720}
                      height={360}
                      src={post.data.heroImage}
                      aria-hidden="true"
                      asCover
                    />
                    <CardContent>
                      <CardTitle class="title">{post.data.title}</CardTitle>
                      <p class="date">
                        <FormattedDate date={post.data.pubDate} />
                      </p>
                      <Button
                        as="a"
                        href={`/portfolio/${post.slug}/`}
                        width="full-width"
                      >
                        More...
                      </Button>
                    </CardContent>
                  </Card>
                </article>
              ))
            }
          </Grid>
        </Container>
      </Section>
    </main>
    <Footer />
  </body>
</html>
